inferer: !!python/object:factorizer.datasets.isles.ISLESInferer
  device: null
  inferer: !!python/object:monai.inferers.inferer.SlidingWindowInferer
    cval: 0.0
    device: null
    mode: !!python/object/apply:monai.utils.enums.BlendMode
    - constant
    overlap: 0.5
    padding_mode: !!python/object/apply:monai.utils.enums.PytorchPadMode
    - constant
    progress: false
    roi_size:
    - 64
    - 64
    - 64
    roi_weight_map: null
    sigma_scale: 0.125
    sw_batch_size: 1
    sw_device: null
  interpolate: !!python/object:factorizer.data.transforms.Interpolate
    key: input
    kwargs:
      mode: trilinear
    meta_key: input_meta_dict
    new_size: null
    orig_size: null
    orig_spacing: null
    spacing: !!python/object/apply:torch._utils._rebuild_tensor_v2
    - !!python/object/apply:torch.storage._load_from_bytes
      - !!binary |
        gAKKCmz8nEb5IGqoUBkugAJN6QMugAJ9cQAoWBAAAABwcm90b2NvbF92ZXJzaW9ucQFN6QNYDQAA
        AGxpdHRsZV9lbmRpYW5xAohYCgAAAHR5cGVfc2l6ZXNxA31xBChYBQAAAHNob3J0cQVLAlgDAAAA
        aW50cQZLBFgEAAAAbG9uZ3EHSwR1dS6AAihYBwAAAHN0b3JhZ2VxAGN0b3JjaApGbG9hdFN0b3Jh
        Z2UKcQFYCQAAADI2OTU3MzM2MHECWAMAAABjcHVxA0sDTnRxBFEugAJdcQBYCQAAADI2OTU3MzM2
        MHEBYS4DAAAAAAAAAAAAAEAAAABAAAAAQA==
    - 0
    - !!python/tuple
      - 3
    - !!python/tuple
      - 1
    - false
    - !!python/object/apply:collections.OrderedDict
      - []
  output_dtype: !!python/name:numpy.uint8 ''
  post: !!python/object:monai.transforms.utility.dictionary.Lambdad
    _lambd: !!python/object:monai.transforms.utility.array.Lambda
      func: null
      inv_func: &id001 !!python/name:monai.data.utils.no_collation ''
    allow_missing_keys: false
    func: !!python/tuple
    - !!python/name:factorizer.datasets.isles.%3Clambda%3E ''
    inv_func: !!python/tuple
    - *id001
    keys: !!python/tuple
    - input
    overwrite: !!python/tuple
    - true
  write_dir: null
loss: !!python/object:factorizer.utils.losses.DeepSuprLoss
  _backward_hooks: !!python/object/apply:collections.OrderedDict
  - []
  _backward_pre_hooks: !!python/object/apply:collections.OrderedDict
  - []
  _buffers: {}
  _forward_hooks: !!python/object/apply:collections.OrderedDict
  - []
  _forward_hooks_always_called: !!python/object/apply:collections.OrderedDict
  - []
  _forward_hooks_with_kwargs: !!python/object/apply:collections.OrderedDict
  - []
  _forward_pre_hooks: !!python/object/apply:collections.OrderedDict
  - []
  _forward_pre_hooks_with_kwargs: !!python/object/apply:collections.OrderedDict
  - []
  _is_full_backward_hook: null
  _load_state_dict_post_hooks: !!python/object/apply:collections.OrderedDict
  - []
  _load_state_dict_pre_hooks: !!python/object/apply:collections.OrderedDict
  - []
  _modules:
    loss: !!python/object:monai.losses.dice.DiceCELoss
      _backward_hooks: !!python/object/apply:collections.OrderedDict
      - []
      _backward_pre_hooks: !!python/object/apply:collections.OrderedDict
      - []
      _buffers: {}
      _forward_hooks: !!python/object/apply:collections.OrderedDict
      - []
      _forward_hooks_always_called: !!python/object/apply:collections.OrderedDict
      - []
      _forward_hooks_with_kwargs: !!python/object/apply:collections.OrderedDict
      - []
      _forward_pre_hooks: !!python/object/apply:collections.OrderedDict
      - []
      _forward_pre_hooks_with_kwargs: !!python/object/apply:collections.OrderedDict
      - []
      _is_full_backward_hook: null
      _load_state_dict_post_hooks: !!python/object/apply:collections.OrderedDict
      - []
      _load_state_dict_pre_hooks: !!python/object/apply:collections.OrderedDict
      - []
      _modules:
        cross_entropy: !!python/object:torch.nn.modules.loss.CrossEntropyLoss
          _backward_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _backward_pre_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _buffers:
            weight: null
          _forward_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _forward_hooks_always_called: !!python/object/apply:collections.OrderedDict
          - []
          _forward_hooks_with_kwargs: !!python/object/apply:collections.OrderedDict
          - []
          _forward_pre_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _forward_pre_hooks_with_kwargs: !!python/object/apply:collections.OrderedDict
          - []
          _is_full_backward_hook: null
          _load_state_dict_post_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _load_state_dict_pre_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _modules: {}
          _non_persistent_buffers_set: !!set {}
          _parameters: {}
          _state_dict_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _state_dict_pre_hooks: !!python/object/apply:collections.OrderedDict
          - []
          ignore_index: -100
          label_smoothing: 0.0
          reduction: mean
          training: true
        dice: !!python/object:monai.losses.dice.DiceLoss
          _backward_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _backward_pre_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _buffers: {}
          _forward_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _forward_hooks_always_called: !!python/object/apply:collections.OrderedDict
          - []
          _forward_hooks_with_kwargs: !!python/object/apply:collections.OrderedDict
          - []
          _forward_pre_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _forward_pre_hooks_with_kwargs: !!python/object/apply:collections.OrderedDict
          - []
          _is_full_backward_hook: null
          _load_state_dict_post_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _load_state_dict_pre_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _modules: {}
          _non_persistent_buffers_set: !!set {}
          _parameters: {}
          _state_dict_hooks: !!python/object/apply:collections.OrderedDict
          - []
          _state_dict_pre_hooks: !!python/object/apply:collections.OrderedDict
          - []
          batch: false
          include_background: true
          jaccard: false
          other_act: null
          reduction: mean
          sigmoid: true
          smooth_dr: 1.0e-05
          smooth_nr: 1.0e-05
          softmax: false
          squared_pred: true
          to_onehot_y: false
          training: true
      _non_persistent_buffers_set: !!set {}
      _parameters: {}
      _state_dict_hooks: !!python/object/apply:collections.OrderedDict
      - []
      _state_dict_pre_hooks: !!python/object/apply:collections.OrderedDict
      - []
      lambda_ce: 1.0
      lambda_dice: 1.0
      reduction: mean
      training: true
  _non_persistent_buffers_set: !!set {}
  _parameters: {}
  _state_dict_hooks: !!python/object/apply:collections.OrderedDict
  - []
  _state_dict_pre_hooks: !!python/object/apply:collections.OrderedDict
  - []
  training: true
metrics:
  dice: !!python/object:factorizer.utils.metrics.DiceMetric
    _buffers: null
    _synced: false
    _synced_tensors: null
    get_not_nans: false
    include_background: true
    include_zero_masks: true
    reduction: !!python/object/apply:monai.utils.enums.MetricReduction
    - mean
  hd: !!python/object:factorizer.utils.metrics.HausdorffDistanceMetric
    _buffers: null
    _synced: false
    _synced_tensors: null
    directed: false
    distance_metric: euclidean
    get_not_nans: false
    include_background: true
    include_zero_masks: true
    percentile: 95
    reduction: !!python/object/apply:monai.utils.enums.MetricReduction
    - mean
network: !!python/object/apply:functools.partial
  args:
  - &id002 !!python/name:factorizer.factorizer.SegmentationFactorizer ''
  state: !!python/tuple
  - *id002
  - !!python/tuple []
  - decoder_depth:
    - 1
    - 1
    - 1
    - 1
    downsample:
    - &id003 !!python/name:torch.nn.modules.conv.Conv3d ''
    - bias: false
      kernel_size: 2
    dropout: 0.1
    encoder_depth:
    - 1
    - 1
    - 1
    - 1
    - 1
    encoder_width:
    - 32
    - 64
    - 128
    - 256
    - 512
    head:
    - *id003
    - kernel_size: 1
    in_channels: 2
    mlp:
    - !!python/name:factorizer.layers.mlp.MLP ''
    - dropout: 0.1
      ratio: 4
    nmf:
    - !!python/name:factorizer.factorizer.FactorizerSubblock ''
    - act: !!python/name:torch.nn.modules.activation.ReLU ''
      dropout: 0.1
      factorize: !!python/name:factorizer.factorization.matrix_factorizations.NMF ''
      init: uniform
      num_grad_steps: null
      num_iters: 5
      rank: 1
      solver: hals
      tensorize:
      - !!python/name:factorizer.factorization.operations.SWMatricize ''
      - head_dim: 4
        patch_size: 4
    num_deep_supr: 3
    out_channels: 1
    pos_embed: true
    spatial_size:
    - 64
    - 64
    - 64
    stem:
    - *id003
    - bias: false
      kernel_size: 3
      padding: 1
    strides:
    - 1
    - 2
    - 2
    - 2
    - 2
    upsample:
    - !!python/name:torch.nn.modules.conv.ConvTranspose3d ''
    - kernel_size: 2
  - null
optimizer:
- !!python/name:torch.optim.adamw.AdamW ''
- lr: 0.0001
  weight_decay: 0.01
scheduler:
- !!python/name:factorizer.utils.schedulers.WarmupCosineSchedule ''
- total_steps: 100000
  warmup_steps: 2000
scheduler_config:
  interval: step
